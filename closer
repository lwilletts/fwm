#!/bin/sh
#
# closer

ARGS="$@"

usage() {
    cat >&2 << EOF
Usage: $(basename $0) [direction]
    -u | up:    Focus next window up.
    -l | left:  Focus next window left.
    -d | down:  Focus next window down.
    -r | right: Focus next window right.
    -h | help:  Show this help.
EOF

    test $# -eq 0 || exit $1
}

windowsUp() {
    wid="$(lsw | xargs wattr yi | sort -nr | \
        sed -n "/$PFW/{n;p}" | cut -d\  -f 2)"
}

windowsDown() {
    wid="$(lsw | xargs wattr yi | sort -n | \
        sed -n "/$PFW/{n;p}" | cut -d\  -f 2)"
}

windowsLeft() {
    wid="$(lsw | xargs wattr xi | sort -nr | \
        sed -n "/$PFW/{n;p}" | cut -d\  -f 2)"
}

windowsRight() {
    wid="$(lsw | xargs wattr xi | sort -n | \
        sed -n "/$PFW/{n;p}" | cut -d\  -f 2)"
}

main() {
    PFW=$(pfw)

    case "$1" in
        -u|--up|up)       windowsUp    ;;
        -d|--down|down)   windowsDown  ;;
        -l|--left|left)   windowsLeft  ;;
        -r|--right|right) windowsRight ;;
        -h|--help|help)   usage 0      ;;
        *)                usage 1      ;;
    esac

    test ! -z "$wid" && focus --wid "$wid"
}

main $ARGS
